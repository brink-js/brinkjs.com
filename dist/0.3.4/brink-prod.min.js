(function(){"use strict";var t,e,n,r,i,o;r="undefined"!=typeof module&&module.exports,i=!r,e=r?global:window,n=e.Brink||e.$b||{},n.IS_NODE=r,n.IS_BROWSER=i,o=function(){},r?(e=global,e.include=e.include||require):e=window,t=e.$b=e.Brink=function(){var n;if(n=Array.prototype.slice.call(arguments,0),n.length){if(1===n.length&&"string"==typeof n[0]&&t.require)return t.require.apply(e,n);if(t.define)return Array.isArray(n[0])||Array.isArray(n[1])||n.splice(n.length-1,0,[]),t.define.apply(e,n)}return t},function(){Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,r;for(r=this.length||0,n=0;r>n;n++)t.call(e,this[n],n,this)})}(),function(){Array.prototype.filter||(Array.prototype.filter=function(t,e){var n=[];return this.forEach(function(r,i){t.call(e,r,i,this)&&n.push(r)}),n})}(),function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(!this.length||!(this instanceof Array)||arguments.length<1)return-1;if(e=e||0,e>=this.length)return-1;for(;e<this.length;){if(this[e]===t)return e;e+=1}return-1})}(),function(){Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})}(),function(t,e,n,r){function i(t,e){for(var n=0,r=t.length;r>n;n++)y(t[n],e)}function o(t){for(var e,n=0,r=t.length;r>n;n++)e=t[n],w(e,F[a(e)])}function s(t){return function(e){et(e)&&(y(e,t),i(e.querySelectorAll($),t))}}function a(t){var e=t.getAttribute("is"),n=t.nodeName.toUpperCase(),r=L.call(I,e?M+e.toUpperCase():N+n);return e&&r>-1&&!u(n,e)?-1:r}function u(t,e){return-1<$.indexOf(t+'[is="'+e+'"]')}function c(t){var e=t.currentTarget,n=t.attrChange,r=t.prevValue,i=t.newValue;e.attributeChangedCallback&&"style"!==t.attrName&&e.attributeChangedCallback(t.attrName,n===t[C]?null:r,n===t[T]?null:i)}function l(t){var e=s(t);return function(t){e(t.target)}}function f(t){ft&&(ft=!1,t.currentTarget.removeEventListener(R,f)),i((t.target||e).querySelectorAll($),t.detail===O?O:k),tt&&d()}function h(t,e){var n=this;it.call(n,t,e),m.call(n,{target:n})}function p(t,e){J(t,e),v?v.observe(t,at):(lt&&(t.setAttribute=h,t[A]=_(t),t.addEventListener(E,m)),t.addEventListener(P,c)),t.createdCallback&&(t.created=!0,t.createdCallback(),t.created=!1)}function d(){for(var t,e=0,n=nt.length;n>e;e++)t=nt[e],S.contains(t)||(nt.splice(e,1),y(t,O))}function y(t,e){var n,r=a(t);r>-1&&(b(t,F[r]),r=0,e!==k||t[k]?e!==O||t[O]||(t[k]=!1,t[O]=!0,r=1):(t[O]=!1,t[k]=!0,r=1,tt&&L.call(nt,t)<0&&nt.push(t)),r&&(n=t[e+"Callback"])&&n.call(t))}if(t&&!(r in e)){var m,g,_,v,b,w,A="__"+r+(1e5*Math.random()>>0),k="attached",O="detached",x="extends",C="ADDITION",j="MODIFICATION",T="REMOVAL",P="DOMAttrModified",R="DOMContentLoaded",E="DOMSubtreeModified",N="<",M="=",D=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,K=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],I=[],F=[],$="",S=e.documentElement,L=I.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},z=n.prototype,B=z.hasOwnProperty,q=z.isPrototypeOf,U=n.defineProperty,V=n.getOwnPropertyDescriptor,H=n.getOwnPropertyNames,G=n.getPrototypeOf,W=n.setPrototypeOf,Q=!!n.__proto__,Z=n.create||function ht(t){return t?(ht.prototype=t,new ht):this},J=W||(Q?function(t,e){return t.__proto__=e,t}:H&&V?function(){function t(t,e){for(var n,r=H(e),i=0,o=r.length;o>i;i++)n=r[i],B.call(t,n)||U(t,n,V(e,n))}return function(e,n){do t(e,n);while(n=G(n));return e}}():function(t,e){for(var n in e)t[n]=e[n];return t}),X=t.MutationObserver||t.WebKitMutationObserver,Y=(t.HTMLElement||t.Element||t.Node).prototype,tt=!q.call(Y,S),et=tt?function(t){return 1===t.nodeType}:function(t){return q.call(Y,t)},nt=tt&&[],rt=Y.cloneNode,it=Y.setAttribute,ot=Y.removeAttribute,st=e.createElement,at=X&&{attributes:!0,characterData:!0,attributeOldValue:!0},ut=X||function(t){lt=!1,S.removeEventListener(P,ut)},ct=!1,lt=!0,ft=!0;W||Q?(b=function(t,e){q.call(e,t)||p(t,e)},w=p):(b=function(t,e){t[A]||(t[A]=n(!0),p(t,e))},w=b),tt?(lt=!1,function(){var t=V(Y,"addEventListener"),e=t.value,n=function(t){var e=new CustomEvent(P,{bubbles:!0});e.attrName=t,e.prevValue=this.getAttribute(t),e.newValue=null,e[T]=e.attrChange=2,ot.call(this,t),this.dispatchEvent(e)},r=function(t,e){var n=this.hasAttribute(t),r=n&&this.getAttribute(t),i=new CustomEvent(P,{bubbles:!0});it.call(this,t,e),i.attrName=t,i.prevValue=n?r:null,i.newValue=e,n?i[j]=i.attrChange=1:i[C]=i.attrChange=0,this.dispatchEvent(i)},i=function(t){var e,n=t.currentTarget,r=n[A],i=t.propertyName;r.hasOwnProperty(i)&&(r=r[i],e=new CustomEvent(P,{bubbles:!0}),e.attrName=r.name,e.prevValue=r.value||null,e.newValue=r.value=n[i]||null,null==e.prevValue?e[C]=e.attrChange=0:e[j]=e.attrChange=1,n.dispatchEvent(e))};t.value=function(t,o,s){t===P&&this.attributeChangedCallback&&this.setAttribute!==r&&(this[A]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,e.call(this,"propertychange",i)),e.call(this,t,o,s)},U(Y,"addEventListener",t)}()):X||(S.addEventListener(P,ut),S.setAttribute(A,1),S.removeAttribute(A),lt&&(m=function(t){var e,n,r,i=this;if(i===t.target){e=i[A],i[A]=n=_(i);for(r in n){if(!(r in e))return g(0,i,r,e[r],n[r],C);if(n[r]!==e[r])return g(1,i,r,e[r],n[r],j)}for(r in e)if(!(r in n))return g(2,i,r,e[r],n[r],T)}},g=function(t,e,n,r,i,o){var s={attrChange:t,currentTarget:e,attrName:n,prevValue:r,newValue:i};s[o]=t,c(s)},_=function(t){for(var e,n,r={},i=t.attributes,o=0,s=i.length;s>o;o++)e=i[o],n=e.name,"setAttribute"!==n&&(r[n]=e.value);return r})),e[r]=function(t,n){if(r=t.toUpperCase(),ct||(ct=!0,X?(v=function(t,e){function n(t,e){for(var n=0,r=t.length;r>n;e(t[n++]));}return new X(function(r){for(var i,o,s=0,a=r.length;a>s;s++)i=r[s],"childList"===i.type?(n(i.addedNodes,t),n(i.removedNodes,e)):(o=i.target,o.attributeChangedCallback&&"style"!==i.attributeName&&o.attributeChangedCallback(i.attributeName,i.oldValue,o.getAttribute(i.attributeName)))})}(s(k),s(O)),v.observe(e,{childList:!0,subtree:!0})):(e.addEventListener("DOMNodeInserted",l(k)),e.addEventListener("DOMNodeRemoved",l(O))),e.addEventListener(R,f),e.addEventListener("readystatechange",f),e.createElement=function(t,n){var r=st.apply(e,arguments),i=""+t,o=L.call(I,(n?M:N)+(n||i).toUpperCase()),s=o>-1;return n&&(r.setAttribute("is",n=n.toLowerCase()),s&&(s=u(i.toUpperCase(),n))),s&&w(r,F[o]),r},Y.cloneNode=function(t){var e=rt.call(this,!!t),n=a(e);return n>-1&&w(e,F[n]),t&&o(e.querySelectorAll($)),e}),-2<L.call(I,M+r)+L.call(I,N+r))throw new Error("A "+t+" type is already registered");if(!D.test(r)||-1<L.call(K,r))throw new Error("The type "+t+" is invalid");var r,c=function(){return e.createElement(d,p&&r)},h=n||z,p=B.call(h,x),d=p?n[x].toUpperCase():r,y=I.push((p?M:N)+r)-1;return $=$.concat($.length?",":"",p?d+'[is="'+t.toLowerCase()+'"]':d),c.prototype=F[y]=B.call(h,"prototype")?h.prototype:Z(Y),i(e.querySelectorAll($),k),c}}}("undefined"==typeof window?!1:window,"undefined"==typeof document?!1:document,Object,"registerElement"),function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:t||window,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i})}(),function(){var t="undefined"!=typeof window?window:global;if(!("undefined"==typeof t||t.requestAnimationFrame&&t.cancelAnimationFrame)){for(var e=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!t.requestAnimationFrame;r++)t.requestAnimationFrame=t[n[r]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n[r]+"CancelAnimationFrame"]||t[n[r]+"CancelRequestAnimationFrame"];return t.requestAnimationFrame||(t.requestAnimationFrame=function(n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),o=t.setTimeout(function(){n(r+i)},i);return e=r+i,o}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)}),t.requestAnimationFrame}}(),t.F=o,t.assert=t.error=o,function(){var e,n,r,i,o;o=0,e="undefined"!=typeof module&&module.exports,n=e?global:window,r="undefined"!=typeof require?require:null,i=function(){function n(t,e){for(t=t.replace(/(^|[^\.])(\.\/)/g,"$1");e!==t;)e=t,t=t.replace(/([\w,\-]*[\/]{1,})([\.]{2,}\/)/g,"");return t.replace(/(\/{2,})/g,"/")}function i(){return{id:null,module:null,url:null,attachTo:null,attachPath:null,attach:function(t){var e;for(this.attachPath=t,t=t.split("."),this.attachTo=v(t[0]),e=1;e<t.length;e++)this.attachTo=this.attachTo[t[e]]=this.attachTo[t[e]]||{};this.module&&this.resolve()},resolve:function(e,n){var r,i;return e&&(this.id=e),n&&(this.module=n),r=x[e]||{id:this.id},r.module=this.module,r.url=this.url||r.url,r.attachPath=this.attachPath||r.attachPath,r.order=r.order||o++,x[e]=r,n=this.module.exports||this.module,this.attachTo?(i=this.id.split("/").pop(),"$b"===this.attachPath&&(p(i,this.module),t.CoreObject&&n.prototype instanceof t.CoreObject&&(n.__meta=n.__meta||{},n.__meta.name="Brink."+i)),void(this.attachTo[i]=this.module.exports||this.module)):void(this.id&&n&&n.__meta&&(n.__meta.name=this.id))}}}function s(t){return t.substr(0,t.lastIndexOf("/"))}function a(t,e){return e=t&&t.indexOf(".")<0?"":e,t&&(~j.indexOf(t)||~t.indexOf("!"))?t.replace(/([\d,\w,\s,\.\/]*)(?=\!)/,function(t,n){return a(n,e)}):n((e?e+"/":"")+t)}function u(t,e,n,r){for(t=w.length-1;~t&&(n=w[t]);t--){for(r=1,e=n.m.length-1;~e&&r;e--)r=p(n.m[e]);r&&(w.splice(t,1),v(n.m,n.cb))}}function c(e,n,r){A.length&&(r=A.splice(0,1)[0],r&&(r.splice(0,0,e),r.splice(3,0,1),r.splice(4,0,0),n&&(r[5].url=n),g.apply(t,r)))}function l(t,n,i,o,s,a){return e?(r(t),c(n,t),1):(b=b||document.getElementsByTagName("head")[0],i=document.createElement("script"),i.src=t,i.onreadystatechange=i.onload=function(){i.readyState&&"complete"!==i.readyState&&"loaded"!==i.readyState||(clearTimeout(a),i.onload=i.onreadystatechange=i.onerror=null,c(n,t))},i.onerror=function(){throw clearTimeout(a),i.onload=i.onreadystatechange=i.onerror=null,new Error(t+" failed to load.")},a=setTimeout(i.onerror,1e3*E),b.insertBefore(i,b.firstChild),1)}function f(t,e,n,r,i,o,s){for(i={m:t,cb:e},w.push(i),r=0;r<t.length;r++)o=t[r],~o.indexOf("!")?h(o,n,i,r):(s=d(o),k[s]=p(o)||k[s]?1:l(s,o))}function h(t,e,r,i,o,l,f){return f=(e?e+"/":"")+"plugins/"+t.replace(/\//g,"_"),r&&(r.m[i]=f),t=t.split("!"),l=t.splice(0,1)[0],t=t.join("!"),o=p(f),!r||o?o:void v(l,function(o){function h(t){p(f,{exports:t}),u()}return t=o.normalize?o.normalize(t,function(t){return a(t,e)}):a(n(t),e),h.fromText=function(t,e,n){r.m[i]=f=t,n=A.length,new Function(e)(),A.length-n&&c(f)},o.load(t,v.localize(s(l)),h,T[l]||{})})}function p(t,e,n,r){return~j.indexOf(t)?t:(r=O[t]=e||O[t],r&&r.exports?n?r:r.exports:0)}function d(t,e){e=t.indexOf("/")&&t.indexOf("http")?P:"";for(var n in N)t=t.replace(new RegExp("(^"+n+")","g"),N[n]);return e+t+(t.indexOf(".")<0?".js":"")+R}function y(t,e,n){for(var r in e)n=t.indexOf(r),~n&&(t[n]=e[r]);return t}function m(t,e,n,r,i,o,s,a){for(C[t]=e,r=0;r<e.length;r++)if(o=e[r],s=C[o])for(i=0;i<s.length;i++)a=s[i],e.indexOf(a)<0&&(a!==t?e.push(a):p(o,{exports:{}}))}function g(t,e,n,r,o,a,c,l,f,h,d){return a||(a=i()),"string"!=typeof t?(n=e,e=t,t=0,A.push([e,n,a]),a):(Array.isArray(e)||(n=e,e=[]),f=s(t),d=v.localize(f),e.length||!n.length||"function"!=typeof n||n.__meta||(n.toString().replace(/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,"").replace(/(?:require)\(\s*['']([^''\s]+)['']\s*\)/g,function(t,n){e.indexOf(n)<0&&e.push(n)}),e=j.slice(0,n.length).concat(e)),e.length&&!o?(m(t,e.slice(0)),d(e,function(){g(t,Array.prototype.slice.call(arguments,0),n,1,1,a)}),a):(c=p(t,0,1),c=c||{exports:{}},"function"!=typeof n||n.__meta?c.exports=n:(l=y(e.length?e:j.slice(0,n.length),{require:d,module:c,exports:c.exports}),h=l.indexOf(v),~h&&(l[h]=d),c.exports=n.apply(n,l)||c.exports),p(t,c),a.resolve(t,c),delete C[t],u(),a))}function _(t){O[t]=x[t]=null,delete O[t],delete x[t]}function v(e,n,r,i,o,s,u){if(!n&&"string"==typeof e)return e=a(e,r),n=p(e),n?n:(u=h(e,r),u?u:{id:e,__isRequire:!0,resolve:function(t){return v(e,t)}});for(n||(n=function(){}),e=Array.isArray(e)?e:[e],s=[],o=0;o<e.length;o++)e[o]=a(e[o],r),s.push(p(e[o]));return~s.indexOf(0)?void f(e,n,r):n.apply(t,y(s,{require:v}))}var b,w=[],A=[],k={},O=t.__registry={},x={},C={},j=["require","exports","module"],T={},P="",R="",E=10,N={};return g.amd={},v.config=function(t){T=t||{},P=T.baseUrl?T.baseUrl:P,P+=P&&"/"!==P.charAt(P.length-1)?"/":"",P=n(P),R=T.urlArgs?"?"+T.urlArgs:R,E=T.waitSeconds||E;for(var e in T.paths)N[e]=T.paths[e]},v.toUrl=function(t,e){return d(a(t,e))},v.metas=function(){var t,e;e=[];for(t in x)e.push(x[t]);return e.sort(function(t,e){return t.order-e.order})},v.localize=function(t){function e(e,n){return v(e,n,t)}return e.toUrl=function(e){return v.toUrl(e,t)},e},{require:v,define:g,undefine:_}}(),t.require=i.require,t.define=i.define,t.undefine=i.undefine,r&&(require=r)}.call(this),t.require.config(n),t.define("$b",t),t.configure=function(e){var r;for(r in e)n[r]=e[r];return t.require.config(n),t},t.init=function(e,r){t.require([],function(){t.merge(t.config,n),t.isFunction(e)?(r=e)(t):(e=e||[],e.length?t.require(e,r):r&&r())})},r&&(t.build=function(){var e=arguments;t.init(function(){t.build.apply(null,e)})},t.configure({paths:{brink:__dirname,plugins:__dirname+"/amd"}}),t.init(),t.configure({paths:null}),module.exports=t),t.define("brink/config",function(){return{}}).attach("$b"),t("brink/utils/isFunction",function(){return function(t){return"function"==typeof t}}).attach("$b"),t("brink/utils/computed",["./isFunction"],function(t){return function(e){return t(e)&&(e={watch:arguments[1],get:e}),"undefined"==typeof e.value&&(e.value=e.defaultValue),e.watch=e.hasOwnProperty("watch")?[].concat(e.watch):[],e.__meta={},e.__isComputed=!0,e.meta=function(t){var n;if("undefined"!=typeof t)for(n in t)e.__meta[n]=t[n];return e.__meta}.bind(e),e}}).attach("$b"),t("brink/utils/alias",["./computed"],function(t){return function(e){return t({watch:[e],get:function(){return this.get(e)},set:function(t){return this.set(e,t)}})}}).attach("$b"),t("brink/utils/get",[],function(){return function(e,n){var r,i;for(n=n.split("."),r=0;r<n.length;r++){if(i=n[r],!e)return null;if(e instanceof t.Object){if(e.isDestroyed)return null;e=e.__meta.getters[i]?e.__meta.getters[i].call(e,i):e.__meta.pojoStyle?e[i]:e.__meta.values[i]}else e=e[i]}return e}}).attach("$b"),t("brink/utils/getObjKeyPair",["./get"],function(t){return function(e,n,r){var i,o;for(n=n.split("."),i=0;i<n.length-1;i++)o=t(e,n[i]),null==o&&r&&(o=e[n[i]]={}),e=o;return n=n.pop(),[e,n]}}).attach("$b"),t("brink/utils/isBrinkInstance",[],function(){return function(t){return t.constructor.__meta.isObject}}).attach("$b"),t("brink/utils/bindTo",["./alias","./computed","./getObjKeyPair","./isBrinkInstance"],function(e,n,r,i){return function(r,o,s){var a;return arguments.length>1?(t.assert("Object must be an instance of Brink.Object or Brink.Class",i(r)),s||r.prop(o),a=n({boundTo:[r,o],get:function(){return r.get(o)},set:function(t){return r.set(o,t)}})):a=e(r),a}}).attach("$b"),t("brink/utils/isObject",function(){var t={"function":!0,object:!0,unknown:!0};return function(e){return e?!!t[typeof e]:!1}}).attach("$b"),t("brink/utils/merge",["./isObject"],function(t){return function e(n,r,i){function o(e){return Array.isArray(e)?[]:t(e)?{}:!1}var s,a,u;if(Array.isArray(n)||Array.isArray(r)){for(n=n||[],r=r||[],s=0;s<r.length;s++)a=r[s],~n.indexOf(a)||(u=i?o(a):null,n.push(u?e(u,a,!0):a));return n}if(t(n)||t(r)){n=n||{},r=r||{};for(s in r)a=r[s],r.hasOwnProperty(s)&&(u=i?o(a):null,n[s]=u?e(u,a,!0):a);return n}return null}}).attach("$b"),t("brink/utils/clone",["./merge","./isObject"],function(t,e){return function(n,r,i){function o(t){return Array.isArray(t)?[]:e(t)?{}:null}return i=o(n),i?t(i,n,r):null}}).attach("$b"),t("brink/utils/configure",["./merge","../config"],function(e,n){return function(e){return t.merge(n,e),n}}).attach("$b"),t("brink/utils/defineProperty",["./isBrinkInstance"],function(e){return function(n,r,i){var o;return o=i,o.__meta&&(o.__meta.isAttribute||o.__meta.isRelationship)&&(o=o.clone()),t.assert("Object must be an instance of Brink.Object or Brink.Class",e(n)),o.configurable=!0,o.enumerable="undefined"!==i.enumerable?i.enumerable:!0,0===r.indexOf("__")&&(o.configurable=!1,o.enumerable=!1),o.get=n.__defineGetter(r,i.get||n.__writeOnly(r)),o.set=n.__defineSetter(r,i.set||n.__readOnly(r)),o.defaultValue="undefined"!=typeof i.defaultValue?i.defaultValue:i.value,delete o.value,delete o.writable,o}}).attach("$b"),t("brink/utils/extend",["./isObject","./isFunction"],function(t,e){function n(e){return t(e)&&e.constructor===Object}function r(t){return Array.isArray(t)}function i(o){var s,a,u,c,l,f,h,p,d;for("object"==typeof o||e(o)||(o={}),s=t(arguments[1])?1:2,f=arguments[1]===!0,a=arguments.length;a>s;s++)if(null!=(p=arguments[s]))for(h in p)u=o[h],l=p[h],o!==l&&(f&&l&&(n(l)||(d=r(l)))?(d?(d=!1,c=u&&r(u)?u:[]):c=u&&n(u)?u:{},o[h]=i(c,f,l)):void 0!==l&&(o[h]=l));return o}return i}).attach("$b"),t("brink/utils/expandProps",function(){return function(t,e){var n,r,i,o,s,a;for(t=[].concat(t),a=[],r=0;r<t.length;r++){if(o=t[r],!e&&~o.indexOf("."))for(n=o.split("."),n.splice(n.length-1,1),s=null;n.length;)s=s?s+".":"",s+=n.splice(0,1)[0],a.push(s);if(~o.indexOf(","))for(o=o.split("."),s=o.splice(0,o.length-1).join("."),n=o[0].split(","),o=[],i=0;i<n.length;i++)o.push([s,n[i]].join(s?".":""));a=a.concat(o)}return a}}).attach("$b"),t("brink/utils/flatten",["./merge"],function(t){return function e(n,r){var i,o,s;for(o=[],i=0;i<n.length;i++)s=n[i],Array.isArray(s)&&(s=e(s)),o=o.concat(s);return r||t([],o),o}}).attach("$b"),t("brink/utils/intersect",[],function(){return function(t,e){var n,r,i;if(r=[],n=e.length,!t.length||!n)return r;for(;n--;)i=e[n],~t.indexOf(i)&&r.push(i);return r}}).attach("$b"),t("brink/utils/params",function(){function t(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)})}return function(e,n){var r,i,o=n?t:encodeURIComponent;i="";for(r in e)i+=(i?"&":"")+o(r)+"="+o(e[r]);return i}}).attach("$b"),t("brink/utils/Q",function(){function t(t){return function(){return W.apply(t,arguments)}}function e(t){return t===Object(t)}function n(t){return"[object StopIteration]"===nt(t)||t instanceof U}function r(t,e){if(z&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(rt)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+rt+"\n");t.stack=i(o)}}function i(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var i=e[r];a(i)||o(i)||!i||n.push(i)}return n.join("\n")}function o(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function a(t){var e=s(t);if(!e)return!1;var n=e[0],r=e[1];return n===q&&r>=V&&at>=r}function u(){if(z)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=s(n);if(!r)return;return q=r[0],r[1]}}function c(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}function l(t){return t instanceof d?t:_(t)?j(t):C(t)}function f(){function t(t){e=t,o.source=t,Z(n,function(e,n){l.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],i=Y(f.prototype),o=Y(d.prototype);if(o.promiseDispatch=function(t,i,o){var s=Q(arguments);n?(n.push(s),"when"===i&&o[1]&&r.push(o[1])):l.nextTick(function(){e.promiseDispatch.apply(e,s)})},o.valueOf=function(){if(n)return o;var t=m(e);return g(t)&&(e=t),t},o.inspect=function(){return e?e.inspect():{state:"pending"}},l.longStackSupport&&z)try{throw new Error}catch(s){o.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(n){e||t(l(n))},i.fulfill=function(n){e||t(C(n))},i.reject=function(n){e||t(x(n))},i.notify=function(t){e||Z(r,function(e,n){l.nextTick(function(){n(t)})},void 0)},i}function h(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=f();try{t(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}return e.promise}function p(t){return h(function(e,n){for(var r=0,i=t.length;i>r;r++)l(t[r]).then(e,n)})}function d(t,e,n){void 0===e&&(e=function(t){return x(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=Y(d.prototype);if(r.promiseDispatch=function(n,i,o){var s;try{s=t[i]?t[i].apply(r,o):e.call(r,i,o)}catch(a){s=x(a)}n&&n(s)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function y(t,e,n,r){return l(t).then(e,n,r)}function m(t){if(g(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function g(t){return t instanceof d}function _(t){return e(t)&&"function"==typeof t.then}function v(t){return g(t)&&"pending"===t.inspect().state}function b(t){return!g(t)||"fulfilled"===t.inspect().state}function w(t){return g(t)&&"rejected"===t.inspect().state}function A(){it.length=0,ot.length=0,st||(st=!0)}function k(t,e){st&&(ot.push(t),e&&"undefined"!=typeof e.stack?it.push(e.stack):it.push("(no stack) "+e))}function O(t){if(st){var e=J(ot,t);-1!==e&&(ot.splice(e,1),it.splice(e,1))}}function x(t){var e=d({when:function(e){return e&&O(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return k(e,t),e}function C(t){return d({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},"delete":function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return et(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function j(t){var e=f();return l.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}}),e.promise}function T(t){return d({isDef:function(){}},function(e,n){return D(t,e,n)},function(){return l(t).inspect()})}function P(t,e,n){return l(t).spread(e,n)}function R(t){return function(){function e(t,e){var s;if("undefined"==typeof StopIteration){try{s=r[t](e)}catch(a){return x(a)}return s.done?l(s.value):y(s.value,i,o)}try{s=r[t](e)}catch(a){return n(a)?l(a.value):x(a)}return y(s,i,o)}var r=t.apply(this,arguments),i=e.bind(e,"next"),o=e.bind(e,"throw");return i()}}function E(t){l.done(l.async(t)())}function N(t){throw new U(t)}function M(t){return function(){return P([this,K(arguments)],function(e,n){return t.apply(e,n)})}}function D(t,e,n){return l(t).dispatch(e,n)}function K(t){return y(t,function(t){var e=0,n=f();return Z(t,function(r,i,o){var s;g(i)&&"fulfilled"===(s=i.inspect()).state?t[o]=s.value:(++e,y(i,function(r){t[o]=r,0===--e&&n.resolve(t)},n.reject,function(t){n.notify({index:o,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function I(t){if(0===t.length)return l.resolve();var e=l.defer(),n=0;return Z(t,function(r,i,o){function s(t){e.resolve(t)}function a(){n--,0===n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function u(t){e.notify({index:o,value:t})}var c=t[o];n++,y(c,s,a,u)},void 0),e.promise}function F(t){return y(t,function(t){return t=X(t,l),y(K(X(t,function(t){return y(t,H,H)})),function(){return t})})}function $(t){return l(t).allSettled()}function S(t,e){return l(t).then(void 0,void 0,e)}function L(t,e){return l(t).nodeify(e)}var z=!1;try{throw new Error}catch(B){z=!!B.stack}var q,U,V=u(),H=function(){},G=function(){function t(){for(;e.next;){e=e.next;var n=e.task;e.task=void 0;var i=e.domain;i&&(e.domain=void 0,i.enter());try{n()}catch(s){if(o)throw i&&i.exit(),setTimeout(t,0),i&&i.enter(),s;setTimeout(function(){throw s},0)}i&&i.exit()}r=!1}var e={task:void 0,next:null},n=e,r=!1,i=void 0,o=!1;if(G=function(t){n=n.next={task:t,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(t)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){i=a,s.port1.onmessage=t,t()};var a=function(){s.port2.postMessage(0)};i=function(){setTimeout(t,0),a()}}else i=function(){setTimeout(t,0)};return G}(),W=Function.call,Q=t(Array.prototype.slice),Z=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(e=t(e,this[n],n));return e}),J=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),X=t(Array.prototype.map||function(t,e){var n=this,r=[];return Z(n,function(i,o,s){r.push(t.call(e,o,s,n))},void 0),r}),Y=Object.create||function(t){function e(){}return e.prototype=t,new e},tt=t(Object.prototype.hasOwnProperty),et=Object.keys||function(t){var e=[];for(var n in t)tt(t,n)&&e.push(n);return e},nt=t(Object.prototype.toString);U="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var rt="From previous event:";l.resolve=l,l.nextTick=G,l.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=f,f.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(Q(arguments,1)):t.resolve(n)}},l.Promise=h,l.promise=h,h.race=p,h.all=K,h.reject=x,h.resolve=l,l.passByCopy=function(t){return t},d.prototype.passByCopy=function(){return this},l.join=function(t,e){return l(t).join(e)},d.prototype.join=function(t){return l([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},l.race=p,d.prototype.race=function(){return this.then(l.race)},l.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(t,e,n){function i(e){try{return"function"==typeof t?t(e):e}catch(n){return x(n)}}function o(t){if("function"==typeof e){r(t,a);try{return e(t)}catch(n){return x(n)}}return x(t)}function s(t){return"function"==typeof n?n(t):t}var a=this,u=f(),c=!1;return l.nextTick(function(){a.promiseDispatch(function(t){c||(c=!0,u.resolve(i(t)))},"when",[function(t){c||(c=!0,u.resolve(o(t)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=s(t)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||u.notify(e)}]),u.promise},l.tap=function(t,e){return l(t).tap(e)},d.prototype.tap=function(t){return t=l(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},l.when=y,d.prototype.thenResolve=function(t){return this.then(function(){return t})},l.thenResolve=function(t,e){return l(t).thenResolve(e)},d.prototype.thenReject=function(t){return this.then(function(){throw t})},l.thenReject=function(t,e){return l(t).thenReject(e)},l.nearer=m,l.isPromise=g,l.isPromiseAlike=_,l.isPending=v,d.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=b,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=w,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],ot=[],st=!0;l.resetUnhandledRejections=A,l.getUnhandledReasons=function(){return it.slice()},l.stopUnhandledRejectionTracking=function(){A(),st=!1},A(),l.reject=x,l.fulfill=C,l.master=T,l.spread=P,d.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},l.async=R,l.spawn=E,l["return"]=N,l.promised=M,l.dispatch=D,d.prototype.dispatch=function(t,e){var n=this,r=f();return l.nextTick(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},l.get=function(t,e){return l(t).dispatch("get",[e])},d.prototype.get=function(t){return this.dispatch("get",[t])},l.set=function(t,e,n){return l(t).dispatch("set",[e,n])},d.prototype.set=function(t,e){return this.dispatch("set",[t,e])},l.del=l["delete"]=function(t,e){return l(t).dispatch("delete",[e])},d.prototype.del=d.prototype["delete"]=function(t){return this.dispatch("delete",[t])},l.mapply=l.post=function(t,e,n){return l(t).dispatch("post",[e,n])},d.prototype.mapply=d.prototype.post=function(t,e){return this.dispatch("post",[t,e])},l.send=l.mcall=l.invoke=function(t,e){return l(t).dispatch("post",[e,Q(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(t){return this.dispatch("post",[t,Q(arguments,1)])},l.fapply=function(t,e){return l(t).dispatch("apply",[void 0,e])},d.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},l["try"]=l.fcall=function(t){return l(t).dispatch("apply",[void 0,Q(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,Q(arguments)])},l.fbind=function(t){var e=l(t),n=Q(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(Q(arguments))])}},d.prototype.fbind=function(){var t=this,e=Q(arguments);return function(){return t.dispatch("apply",[this,e.concat(Q(arguments))])}},l.keys=function(t){return l(t).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},l.all=K,d.prototype.all=function(){return K(this)},l.any=I,d.prototype.any=function(){return I(this)},l.allResolved=c(F,"allResolved","allSettled"),d.prototype.allResolved=function(){return F(this)},l.allSettled=$,d.prototype.allSettled=function(){return this.then(function(t){return K(X(t,function(t){function e(){return t.inspect()}return t=l(t),t.then(e,e)}))})},l.fail=l["catch"]=function(t,e){return l(t).then(void 0,e)},d.prototype.fail=d.prototype["catch"]=function(t){return this.then(void 0,t)},l.progress=S,d.prototype.progress=function(t){return this.then(void 0,void 0,t)},l.fin=l["finally"]=function(t,e){return l(t)["finally"](e)},d.prototype.fin=d.prototype["finally"]=function(t){return t=l(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},l.done=function(t,e,n,r){return l(t).done(e,n,r)},d.prototype.done=function(t,e,n){var i=function(t){l.nextTick(function(){if(r(t,o),!l.onerror)throw t;l.onerror(t)})},o=t||e||n?this.then(t,e,n):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),o.then(void 0,i)},l.timeout=function(t,e,n){return l(t).timeout(e,n)},d.prototype.timeout=function(t,e){var n=f(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},l.delay=function(t,e){return void 0===e&&(e=t,t=void 0),l(t).delay(e)},d.prototype.delay=function(t){return this.then(function(e){var n=f();return setTimeout(function(){n.resolve(e)},t),n.promise})},l.nfapply=function(t,e){return l(t).nfapply(e)},d.prototype.nfapply=function(t){var e=f(),n=Q(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},l.nfcall=function(t){var e=Q(arguments,1);return l(t).nfapply(e)},d.prototype.nfcall=function(){var t=Q(arguments),e=f();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},l.nfbind=l.denodeify=function(t){var e=Q(arguments,1);return function(){var n=e.concat(Q(arguments)),r=f();return n.push(r.makeNodeResolver()),l(t).fapply(n).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var t=Q(arguments);return t.unshift(this),l.denodeify.apply(void 0,t)},l.nbind=function(t,e){var n=Q(arguments,2);return function(){function r(){return t.apply(e,arguments);
}var i=n.concat(Q(arguments)),o=f();return i.push(o.makeNodeResolver()),l(r).fapply(i).fail(o.reject),o.promise}},d.prototype.nbind=function(){var t=Q(arguments,0);return t.unshift(this),l.nbind.apply(void 0,t)},l.nmapply=l.npost=function(t,e,n){return l(t).npost(e,n)},d.prototype.nmapply=d.prototype.npost=function(t,e){var n=Q(e||[]),r=f();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(t,e){var n=Q(arguments,2),r=f();return n.push(r.makeNodeResolver()),l(t).dispatch("post",[e,n]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(t){var e=Q(arguments,1),n=f();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},l.nodeify=L,d.prototype.nodeify=function(t){return t?void this.then(function(e){l.nextTick(function(){t(null,e)})},function(e){l.nextTick(function(){t(e)})}):this};var at=u();return l}).attach("$b"),t("brink/utils/xhr",["./params","./Q"],function(t,e){var n,r="application/x-www-form-urlencoded";return n=function(t,e,r,i){return n.send(n.prep(t,e,r,i))},n.send=function(t){var n=e.defer();return t.onreadystatechange=function(){var e;4===t.readyState&&(e="json"===t.mimeType&&"json"!==t.responseType?JSON.parse(t.responseText):"json"===t.responseType||"blob"===t.responseType||"document"===t.responseType||"arraybuffer"===t.responseType?t.response:t.responseText,200===t.status?n.resolve(e):n.reject(t))},t.send(),n.promise},n.prep=function(e,n,i,o){var s,a,u;return o=o||{},i=(i||"GET").toUpperCase(),s=new XMLHttpRequest,o.withCredentials&&(s.withCredentials=!0),o.timeout&&(s.timeout=o.timeout),o.mimeType&&(s.overrideMimeType(o.mimeType),s.mimeType=o.mimeType),"POST"===i||"PUT"===i||"PATCH"===i?(u=o.contentType||r,s.open(i,e,!0,o.user||"",o.password||""),s.setRequestHeader("Content-Type",u),a="application/x-www-form-urlencoded"===u?t(n,!0):"application/json"===u?JSON.stringify(n):n):(a=t(n),s.open(i,e+(a?"?"+a:""),!0,o.user||"",o.password||"")),s},n}).attach("$b"),t("brink/utils/ready",[],function(){return function(t){function e(){t&&t()}return"undefined"!=typeof document?"complete"===document.readyState?void e():void document.addEventListener("DOMContentLoaded",e):void t()}}).attach("$b"),t("brink/utils/set",["./get","./getObjKeyPair"],function(e,n){var r=function(i,o,s,a,u){var c,l,f;if("string"==typeof o)return o.indexOf(".")>-1&&(i=n(i,o,!0),o=i[1],i=i[0]),l=e(i,o),f=l!==s,u||f?(i instanceof t.Object?(f&&(l instanceof t.Object&&l.__removeReference(i),s instanceof t.Object&&s.__addReference(i,"proxy"===o&&s instanceof t.ObjectProxy?"":o)),s&&s.__isUnbound&&(s=s.value),i.__meta.setters[o]?i.__meta.setters[o].call(i,s,o):(i.__meta.pojoStyle&&(i[o]=s),i.__meta.values[o]=s),a||i.propertyDidChange(o)):i[o]=s,i):!1;if(2===arguments.length){for(c in o)r(i,c,o[c],s,a);return i}t.error("Tried to call `set` with unsupported arguments",arguments)};return r}).attach("$b"),t("brink/utils/trim",function(){return function(t){return"string"==typeof t?t.replace(/^\s+|\s+$/gm,""):t}}).attach("$b"),t("brink/utils/unbound",[],function(){return function(t){return{value:t,__isUnbound:!0}}}).attach("$b"),t("brink/utils/registerModel",[],function(){return t.__models={},function(e){var n,r;if(n=e.modelKey,r=e.collectionKey,t.__models[n])throw new Error('`modelKey` already registered : "'+n+'".');if(t.__models[r])throw new Error('`collectionKey` already registered : "'+r+'".');t.__models[n]=e,t.__models[r]=e}}).attach("$b"),t("brink/utils/unregisterModel",[],function(){return t.__models={},function(e){var n,r;if(n=e.modelKey,r=e.collectionKey,!t.__models[n])throw new Error('`modelKey` not registered : "'+n+'".');if(!t.__models[r])throw new Error('`collectionKey` not registered : "'+r+'".');t.__models[n]=null,t.__models[r]=null}}).attach("$b"),t("brink/core/CoreObject",["../utils/merge","../utils/extend"],function(t,e){var n;return n=function(){},n.extend=function(n){function r(t){var e;return t===!0||t===!1?(t&&(e=this.__init||this.init||this.constructor,e.call(this)),this):r.extend.apply(r,arguments)}var i,o,s;if(arguments.length>1){for(o=0,i=this;o<arguments.length-1;)i=i.extend(arguments[o]),o++;return i}return s=this.buildPrototype.call(this,n),r.prototype=s,e(r,this,s.statics||{}),r.prototype.constructor=r,r.__meta=t({isObject:!0},r.__meta),r},n.buildPrototype=function(t){var n=function(){};return n.prototype=this.prototype,e(new n,t)},n.inject=function(t,n){return"object"==typeof t?e(this.prototype,t):this.prototype[t]=n,this},n.create=function(){var t,e;return e=new this(!1),t=e.__init||e.init,t&&(e=t.apply(e,arguments)||e),e},n.toString=function(){return this.__meta.name},n}).attach("$b"),t("brink/utils/bindFunction",[],function(){return function(t,e){return function(){return t.apply(e,arguments)}}}).attach("$b"),t("brink/core/Object",["../config","./CoreObject","../utils/get","../utils/set","../utils/clone","../utils/extend","../utils/merge","../utils/bindTo","../utils/flatten","../utils/intersect","../utils/isFunction","../utils/expandProps","../utils/bindFunction","../utils/getObjKeyPair","../utils/defineProperty"],function(e,n,r,i,o,s,a,u,c,l,f,h,p,d,y){var m;return m=n.extend({__init:function(e){var n,r,i;this.__meta?i=this.__buildMeta():(this.__parsePrototype.call(this),i=this.__meta),i.references=[],i.referenceKeys=[],e&&"object"==typeof e&&!Array.isArray(e)&&(e=o(e),this.__appendToMeta(e,i));for(r in i.properties)this.__defineProperty.call(this,r,i.properties[r]);if(this.__autoBindMethods)for(n=0;n<i.methods.length;n++)r=i.methods[n],~r.indexOf("__")||(this[r]=p(this[r],this));return this.init&&this.__callInit!==!1&&this.init.apply(this,arguments),i.isInitialized=!0,t.instanceManager&&t.instanceManager.add(this,i),this},init:function(){},__buildMeta:function(){var t;return t=this.__meta=o(this.__meta||{}),t.getters=o(t.getters||{}),t.setters=o(t.setters||{}),t.properties=o(t.properties||{}),t.methods=o(t.methods||[]),t.dependencies=o(t.dependencies||[]),t.values={},t.watchers={fns:[],props:[]},t.memoizedBindings={},t},__parsePrototype:function(){this.__appendToMeta(this,this.__buildMeta(),!0)},__appendToMeta:function(t,e,n,r){var i,o;for(i in t)o=t[i],f(o)?"constructor"===i||~e.methods.indexOf(i)||(e.methods.push(i),n||(this[i]=t[i])):(r||t.hasOwnProperty(i))&&"__meta"!==i&&(o&&o.__isRequire&&~!e.dependencies.indexOf(i)?e.dependencies.push(i):(o&&o.__meta&&o.__meta.isSchema&&this.__appendToMeta(o,e,n,!0),this.prop.call(this,i,o)))},__defineProperty:function(t,e){e=o(e),Object.defineProperty?Object.defineProperty(this,t,e):this.__defineGetter__?(this.__defineGetter__(t,e.get),this.__defineSetter__(t,e.set)):this.__meta.pojoStyle=!0,"undefined"!=typeof e.defaultValue&&this.set(t,e.defaultValue,!0,!0)},__undefineProperties:function(){var t,e,n,r,i;r=this.__meta,i=r.externalBindings;for(e in i)for(n=0;n<i[e].length;n++)t=i[e][n],t.obj.isDestroyed||t.obj.unwatch(t.localProp.didChange);for(e in this.__meta.properties)delete this[e]},__readOnly:function(e){return this.__meta.pojoStyle?t.error("Tried to write to a read-only property `"+e+"` on "+this):void 0},__writeOnly:function(e){return this.__meta.pojoStyle?t.error("Tried to read a write-only property `"+e+"` on "+this):void 0},__defineGetter:function(t,e){return f(e)&&(this.__meta.getters[t]=e),function(){return this.get(t)}},__defineSetter:function(t,e){return f(e)&&(this.__meta.setters[t]=e),function(e){return this.set(t,e)}},__hasReference:function(t){var e=this.__meta;return!!~e.references.indexOf(t)},__addReference:function(t,e){var n=this.__meta;n.references.push(t),n.referenceKeys.push(e)},__removeReference:function(t){var e,n;n=this.__meta,e=n.references.indexOf(t),~e&&(n.references.splice(e,1),n.referenceKeys.splice(e,1))},propertyDidChange:function(e){t.instanceManager.propertyDidChange(this,e)},getProperties:function(){var t,e,n,r;if(r=c([].slice.call(arguments,0,arguments.length)),n={},arguments.length){for(t=0;t<r.length;t++)n[r[t]]=this.get(r[t]);return n}for(e in this.__meta.properties)n[e]=this.get(e);return n},getChangedProperties:function(){return this.getProperties(t.instanceManager.getChangedProps(this))},prop:function(t,e){var n,r,i,o,s,a,c;if(o=d(this,t),t=o[1],o=o[0]||this,a=o.__meta,a.bindings=a.bindings||{},a.externalBindings=a.externalBindings||{},!e&&"undefined"!=typeof a.properties[t]&&"undefined"==typeof e)return a.properties[t];if(e&&e.__isComputed||(e={get:!0,set:!0,value:e,watch:null}),e=a.properties[t]=y(o,t,e),e.__isComputed&&(e.__meta.key=t),e.key=t,c=e.watch,c&&(r=c.length)){for(s=[];r--;)for(n=c[r].split("."),i=null;n.length;)i=(i?i.concat("."):"").concat(n.splice(0,1)[0]),s.push(n.length?i.concat("."):i);for(r=s.length,r&&(a.memoizedBindings={});r--;)n=a.bindings[s[r]]=a.bindings[s[r]]||[],~n.indexOf(t)||n.push(t)}return e.bindTo=function(t,e){this.prop(e,u(t,e))}.bind(o),e.didChange=function(){o.propertyDidChange(t)}.bind(o),e.boundTo&&(n=a.externalBindings[t]=a.externalBindings[t]||[],n.push({obj:e.boundTo[0],key:e.boundTo[1],localProp:e}),e.boundTo[0].watch(e.boundTo[1],e.didChange)),a.isInitialized&&o.__defineProperty(t,e),e},bindProperty:function(t,e,n){return this.prop(t).bindTo(e,n)},get:function(t){return r(this,t)},set:function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),i.apply(null,t)},watch:function(){var e,n;n=arguments[0],e=arguments[1],t.instanceManager?("function"!=typeof e?(e=[].slice.call(arguments,arguments.length-1,arguments.length)[0],n=1===arguments.length?[]:h(c([].slice.call(arguments,0,arguments.length-1)))):n=h([].concat(n)),t.instanceManager.watch(this,n,e)):t.error("InstanceManager does not exist, can't watch for property changes.")},unwatch:function(){t.instanceManager?t.instanceManager.unwatch(this,c(arguments)):t.error("InstanceManager does not exist, can't watch for property changes.")},unwatchAll:function(){t.instanceManager?t.instanceManager.unwatchAll(this):t.error("InstanceManager does not exist, can't watch for property changes.")},willNotifyWatchers:function(){},didNotifyWatchers:function(){},toString:function(){return"[instance "+this.constructor.__meta.name+"]"},destroy:function(){this.isDestroyed||(this.unwatchAll(),this.__undefineProperties(),t.instanceManager&&t.instanceManager.remove(this),this.__meta=null,this.isDestroyed=!0)}}),m.extend=function(){var t,e;return e=n.extend.apply(this,arguments),t=e.prototype,t.__parsePrototype.call(t),t.constructor=e,e},m}).attach("$b"),t("brink/core/NotificationManager",["../utils/Q"],function(e){function n(t){return o.push(t),r(t)}function r(t){function n(){return 1===t.status&&t.pointer<s.length?(r=s[t.pointer],t.pointer++,e(r.apply(null,[].concat(t,t.args))).then(function(e){return t.response=e,n()})["catch"](function(t){return e.reject(t)})):(s=null,1===t.status&&t.cancel(),e(t.response))}var r,o,s;return o=t.name,i[o]?(s=i[o].slice(0),n()):void 0}var i,o,s,a;return o=[],i={},s=function(t,e){return this.name=t,this.args=e,this},s.prototype.name="",s.prototype.dispatcher=null,s.prototype.status=0,s.prototype.pointer=0,s.prototype.cancel=function(){this.name="",this.status=0,this.pointer=0,this.dispatcher=null,a.cancelNotification(this)},s.prototype.dispatch=function(t){this.status=1,this.pointer=0,this.dispatcher=t,a.publishNotification(this)},a={},a.subscribe=function(t,e,n){n=isNaN(n)?-1:n,i[t]=i[t]||[],-1>=n||n>=i[t].length?i[t].push(e):i[t].splice(n,0,e)},a.unsubscribe=function(t,e){var n=i[t].indexOf(e);n>-1&&i[t].splice(n,1)},a.publish=function(){var t,e=Array.prototype.slice.call(arguments),r=e[0],i=e[e.length-1];return e=e.slice(1,e.length-1),t=new s(r,e),t.status=1,t.pointer=0,t.dispatcher=i,n(t)},a.cancelNotification=function(t){o.splice(o.indexOf(t),1),t=null},t.define("notificationManager",a).attach("$b"),a}).attach("$b.__"),t("brink/core/Class",["../config","./Object","./NotificationManager","../utils/bindFunction","../utils/merge"],function(t,e,n,r,i){function o(t,e){return function(){var n,r=this._super||null;return this._super=e,n=t.apply(this,arguments),this._super=r,n}}var s,a;return a=/xyz/.test(function(){var t;t=!0})?/\bthis\._super\b/:/.*/,s=e({__init:o(function(){return this.__autoBindMethods=!0,this._super.apply(this,arguments)},e.prototype.__init),subscribe:function(t,e,r){this._interestHandlers=this._interestHandlers||{},e&&!this._interestHandlers[t]&&(e=e,n.subscribe(t,e,r),this._interestHandlers[t]=e)},unsubscribe:function(t){this._interestHandlers&&this._interestHandlers[t]&&(n.unsubscribe(t,this._interestHandlers[t]),delete this._interestHandlers[t])},unsubscribeAll:function(){var t;for(t in this._interestHandlers)this._interestHandlers.hasOwnProperty(t)&&this.unsubscribe(t);this._interestHandlers=[]},publish:function(){var t=Array.prototype.slice.call(arguments);return n.publish.apply(n,[].concat(t,this))},destroy:o(function(){return this.unsubscribeAll(),this._super.apply(this,arguments)},e.prototype.destroy)}),s.buildPrototype=function(t){var n,r;r=e.buildPrototype.call(this,t);for(n in t)"function"==typeof t[n]&&"function"==typeof this.prototype[n]&&a.test(t[n])?r[n]=o(t[n],this.prototype[n]):"object"==typeof t[n]&&("concatProps"===n||~(t.concatProps||[]).indexOf(n)||~(this.prototype.concatProps||[]).indexOf(n))&&(r[n]=i(this.prototype[n],t[n]));return r},s}).attach("$b"),t("brink/core/Array",["./Object","../utils/get","../utils/computed"],function(t,e,n){var r,i;return i=Array.prototype,r=t({length:n(function(){return this.content.length},"content"),content:null,oldContent:null,pristineContent:null,getChanges:function(){return{added:[],removed:[],moved:[]}},init:function(t){t=t||[],this.set("content",t),this.set("oldContent",t.concat()),this.set("length",this.content.length),this.contentDidChange=this.contentDidChange.bind(this),this.watch("content",this.contentDidChange)},get:function(e){return isNaN(e)?t.prototype.get.apply(this,arguments):this.content[e]},set:function(e,n){return isNaN(e)?t.prototype.set.apply(this,arguments):(this.replaceAt(e,n),n)},find:function(t,e){var n,r,i,o;for(i=[],n=0,r=this.content.length;r>n;n++)if(o=this.content[n],t.call(e,o,n,this))return o;return null},findBy:function(t,n){return this.find(function(r){return e(r,t)===n})},filter:function(){var t=[];return t=i.filter.apply(this.content,arguments),r.create(t)},filterBy:function(t,n){return this.filter(function(r){return e(r,t)===n})},forEach:function(t,e){var n,r;for(n=0,r=this.content.length;r>n;n++)t.call(e,this.content[n],n,this)},concat:function(){return r.create(this.content.concat())},insertAt:function(t,e){return this.splice(t,0,e),this.get("length")},indexOf:function(t){return this.content.indexOf(t)},push:function(){var t;for(t=0;t<arguments.length;t++)this.insertAt(e(this,"length"),arguments[t]);return e(this,"length")},pop:function(t){return t=e(this,"length")-1,this.removeAt(t)},remove:function(t,e){return e=this.content.indexOf(t),~e?this.removeAt(e):!1},removeAt:function(t,e){return e=i.splice.call(this.content,t,1),this.contentDidChange(),e[0]},replace:function(t,e,n){return n=this.content.indexOf(t),~n?this.replaceAt(n,e):void 0},replaceAt:function(t,e){return this.removeAt(t),this.insertAt(t,e)},splice:function(t,e){var n,r,o;if(o=[],r=i.splice.call(arguments,2,arguments.length),e>0)for(n=t,e=t+e;e>n;)o.push(this.removeAt(t)),n++;for(n=0;n<r.length;n++)this.content.splice(t+n,0,r[n]),this.contentDidChange();return o},shift:function(){return this.removeAt(0)},unshift:function(){for(var t=arguments.length;t--;)this.insertAt(0,arguments[t]);return e(this,"length")},reverse:function(){var t;return this.pristineContent||(this.pristineContent=this.content.concat()),t=i.reverse.apply(this.content,arguments),this.contentDidChange(),this},sort:function(){return this.pristineContent||(this.pristineContent=this.content.concat()),i.sort.apply(this.content,arguments),this.contentDidChange(),this},reset:function(){this.content=this.pristineContent,this.pristineContent=null},willNotifyWatchers:function(){this.getChanges=function(){var t,e,n,r,i,o,s,a;for(s=this.oldContent,a=this.content,e={added:[],removed:[],moved:[]},t=0;t<Math.max(s.length,a.length);t++)n=a[t],r=s[t],n!==r&&(r?(i=a.indexOf(r),~i?e.moved.push({oldIndex:t,newIndex:i,item:r}):e.removed.push({index:t,item:r})):(o=s.indexOf(n),~o?e.moved.push({oldIndex:o,newIndex:t,item:n}):e.added.push({index:t,item:n})));return this.getChanges=function(){return e},e}.bind(this)},didNotifyWatchers:function(){this.oldContent=this.content.concat(),this.__meta&&(this.__meta.contentChanges={})},contentDidChange:function(){this.propertyDidChange("length"),this.propertyDidChange("@each")}})}).attach("$b"),t("brink/core/Dictionary",["./Object"],function(t){return t({keys:null,values:null,init:function(){var t;for(this.keys=[],this.values=[],t=0;t<arguments.length;t++)this.add.apply(this,[].concat(arguments[t]));this.length=this.keys.length},get:function(e){var n;return n="string"!=typeof e?this.keys.indexOf(e):-1,~n?this.values[n]:t.prototype.get.apply(this,arguments)},set:function(e,n){var r;return r="string"!=typeof e?this.keys.indexOf(e):-1,~r?(this.values[r]=n,n):t.prototype.set.apply(this,arguments)},add:function(t,e){this.keys.push(t),this.values[this.keys.length-1]=e},remove:function(){var t,e,n;for(n=[],e=0;e<arguments.length;e++)t=this.keys.indexOf(arguments[e]),~t&&(this.keys.splice(t,1),n.push(this.values.splice(t,1)[0]));return n},has:function(t){return!!~this.keys.indexOf(t)},indexOf:function(t){return this.keys.indexOf(t)},forEach:function(t,e){var n;for(n=0;n<this.keys.length;n++)t.call(e,this.values[n],this.keys[n],n,this);return this}})}).attach("$b"),t("brink/core/ObjectProxy",["./Object","../utils/get","../utils/set","../utils/getObjKeyPair"],function(t,e,n,r){return t({proxy:null,__hasProp:function(t){var e,n;return e=r(this,t),t=e[1],e=e[0]||this,n=e.__meta,"undefined"!=typeof n.properties[t]},get:function(t){return e(this.__hasProp(t)?this:this.get("proxy"),t)},set:function(t,e,r,i){return n(this.__hasProp(t)?this:this.get("proxy"),t,e,r,i)}})}).attach("$b"),t("brink/core/RunLoop",["./CoreObject"],function(t){return t.extend({__interval:"raf",__timerID:null,__started:!1,init:function(t){return this.clear(),"undefined"!=typeof t&&this.setInterval.call(this,t),this},setInterval:function(t){t=isNaN(t)?t.toLowerCase():t,this.__interval="raf"===t||"requestanimationframe"===t?"raf":t,this.stopTimer()&&this.start()},startTimer:function(t){return t=t.bind(this),"raf"===this.__interval?requestAnimationFrame(t):setTimeout(t,this.__interval)},stopTimer:function(){return this.__timerID?("raf"===this.__interval?cancelAnimationFrame(this.__timerID):clearTimeout(this.__timerID),this.__timerID=null,!0):!1},start:function(t){return this.__started=!0,!this.__timerID||t?(this.stopTimer(),this.__timerID=this.startTimer(function(){this.start(!0),this.run()})):void 0},restart:function(){this.start(!0)},stop:function(){return this.__started=!1,this.stopTimer()},defer:function(){return this.start()},deferOnce:function(){return this.stopTimer(),this.__timerID=this.startTimer(function(){this.stopTimer(),this.run()}.bind(this))},run:function(){var t,e,n,r;if(!this.__once.length&&!this.__loop.length)return!1;for(t=0;t<this.__once.length;t++)e=this.__once[t],n=this.__onceArgs[t][0],r=this.__onceArgs[t][1],e.call(r,n);for(t=0;t<this.__loop.length;t++)e=this.__loop[t],n=this.__loopArgs[t][0],r=this.__loopArgs[t][1],e.call(r,n);return this.__once=[],this.__onceArgs=[],!0},once:function(t,e,n){var r=this.__once.indexOf(t);0>r?(this.__once.push(t),r=this.__once.length-1):(e=e||this.__onceArgs[r][0],n=n||this.__onceArgs[r][0]),this.__onceArgs[r]=[e||null,n||null]},loop:function(t,e,n){var r=this.__loop.indexOf(t);0>r&&(this.__loop.push(t),r=this.__loop.length-1),this.__loopArgs[r]=[e||null,n||null]},remove:function(t){var e;e=this.__once.indexOf(t),e>=0&&this.__once.splice(e,1),e=this.__loop.indexOf(t),e>=0&&this.__loop.splice(e,1)},clear:function(){this.__loop=[],this.__once=[],this.__loopArgs=[],this.__onceArgs=[]}})}).attach("$b.__"),t("brink/core/InstanceWatcher",["../config","./CoreObject","./RunLoop","../utils/intersect"],function(t,e,n,r){return e.extend({instanceManager:null,init:function(t){var e;return e=this,this.instanceManager=t,this.runLoop=n.create(),this.runLoop.loop(function(){e.run()}),this},processBindings:function(t,e,n,r,i){var o,s,a,u,c,l,f,h,p,d,y,m,g;for(d=n.bindings,g=n.memoizedBindings=n.memoizedBindings||{},r=r?r.concat("."):"",p=[],i=i||20,o=0,a=m=e.length;a>o;o++){if(r&&m>o?(u=r.concat(e[o]),e[o]=u):u=e[o],y=g[u],null==y){if(y=[],d[u]&&(y=d[u].concat()),d[u+"."]&&Array.prototype.push.apply(y,d[u+"."]),h=u.split("."),h.length>1&&(f=".".concat(h.pop()),c=h.join("."),l=d[c],l&&(s=l.length)))for(;s--;)y.push(l[s].concat(f));g[u]=y}if(i){for(s=y.length;s--;)h=y[s],-1===e.indexOf(h)&&(e[a++]=h);i--}}return e},run:function(){var t,e,n,i,o,s,a,u,c,l,f,h,p,d,y,m,g,_,v;for(h=this.instanceManager,d=h.instances,f=h.changedProps,g=h.changedInstances,u=[],e=0;g.length;)if(i=g[e],p=d[i]){if(s=p.__meta,m=s.references,v=s.referenceKeys,l=f[e],this.processBindings(p,l,s),l.length&&m.length)for(t=s.references.length;t--;)y=m[t],u.indexOf(y)>-1||(u.push(y),o=v[t],a=y.__meta,y.isDestroyed?p.__removeReference(y):(c=this.processBindings(y,l.concat(),a,o),h.propertiesDidChange(y,c)));for(t=s.watchers.fns.length,p.willNotifyWatchers.call(p);t--;)n=s.watchers.fns[t],c=s.watchers.props[t],_=c.length?r(c,l):l.concat(),_.length&&n.call(null,_);p.didNotifyWatchers.call(p),f.splice(e,1),g.splice(e,1)}else f.splice(e,1),g.splice(e,1);h.changedProps=[],h.changedInstances=[],this.stop()},start:function(){this.runLoop.start()},stop:function(){this.runLoop.stop()}})}).attach("$b.__"),t("brink/core/InstanceManager",["../config","./CoreObject","./InstanceWatcher","../utils/get","../utils/merge","../utils/flatten"],function(e,n,r,i,o,s){var a,u=1;return"undefined"!=typeof window&&(window.count=0),a=n.extend({instances:null,changedProps:null,changedInstances:null,init:function(){this.instances={},this.changedProps=[],this.changedInstances=[],this.watcher=r.create(this)},buildMeta:function(t){return t=t||{},t.iid=u++,t},add:function(t,e){return e=this.buildMeta(e),this.instances[e.iid]=t,e},remove:function(t){this.instances[t.__meta.iid]=null},getChangedProps:function(t){var e,n;return n=t.__meta,e=this.changedInstances.indexOf(n.iid),~e?this.changedProps[e]:[]},propertyDidChange:function(t,e){var n,r,i,o,s,a;return i=t.__meta,i.isInitialized?(a=this.changedInstances,s=this.changedProps,r=a.indexOf(i.iid),-1===r?(a.push(i.iid),o=[],s.push(o)):o=s[r],n=o.length,-1===o.indexOf(e)&&(o[n]=e),this.watcher.start(),o):void 0},propertiesDidChange:function(t,e){var n,r,i,o,s,a,u,c;for(s=t.__meta,c=this.changedInstances,u=this.changedProps,o=c.indexOf(s.iid),-1===o?(c.push(s.iid),a=[],u.push(a)):a=u[o],n=e.length,r=a.length;n--;)i=e[n],-1===a.indexOf(i)&&(a[r++]=i);return this.watcher.start(),a},watch:function(t,e,n){var r,i;i=t.__meta,r=i.watchers.fns.indexOf(n),-1===r&&(i.watchers.fns.push(n),r=i.watchers.fns.length-1),i.watchers.props[r]=o(i.watchers.props[r]||[],e),i.watchedProps=s(i.watchers.props)},unwatch:function(t,e){var n,r,i,o;for(o=t.__meta,n=0;n<e.length;n++)r=e[n],i=o.watchers.fns.indexOf(r),~i&&(o.watchers.fns.splice(i,1),o.watchers.props.splice(i,1));o.watchedProps=s(o.watchers.props)},unwatchAll:function(t){var e;e=t.__meta,e&&(e.watchers={fns:[],props:[]},e.watchedProps=[])}}),t.define("instanceManager",a.create({})).attach("$b"),t("instanceManager")}),t("brink/data/Adapter",["../core/Class"],function(e){var n=e({__init:function(){var e;return e=this.constructor.__meta,this.fetch===n.prototype.fetch&&t.warn("`"+e.name+"` must implement the `fetch()` method"),this.fetchAll===n.prototype.fetchAll&&t.warn("`"+e.name+"` must implement the `fetchAll()` method"),this.createRecord===n.prototype.createRecord&&t.warn("`"+e.name+"` must implement the `createRecord()` method"),this.updateRecord===n.prototype.updateRecord&&t.warn("`"+e.name+"` must implement the `updateRecord()` method"),this.deleteRecord===n.prototype.deleteRecord&&t.warn("`"+e.name+"` must implement the `deleteRecord()` method"),this._super.apply(this,arguments)},fetch:t.F,fetchAll:t.F,createRecord:t.F,updateRecord:t.F,deleteRecord:t.F,saveRecord:function(t){return t.get("isNew")?this.createRecord(t):this.updateRecord(t)},registerModel:function(){}});return n}).attach("$b"),t("brink/data/RESTAdapter",["./Adapter","../utils/xhr"],function(t,e){return t({host:"",prefix:"",pluralizeURLs:!1,getURL:function(t,e){var n;return n=[this.get("host"),this.get("prefix")],n.push(t.url||(this.pluralizeURLs?t.collectionKey:t.modelKey)),e&&n.push(t.get("pk")),n.join("/").replace(/([^:]\/)\/+/g,"$1")},fetch:function(t){return e(this.getURL(t,!0),null,"GET")},fetchAll:function(t){return e(this.getURL(t,!1),null,"GET")},createRecord:function(t){return e(this.getURL(t,!1),t.serialize(),"POST")},updateRecord:function(t){return e(this.getURL(t,!0),t.serialize(),"PUT")},deleteRecord:function(t){return e(this.getURL(t,!0),null,"DELETE")}})}).attach("$b"),t("brink/data/attr",["../utils/get","../utils/set","../utils/computed"],function(t,e,n){return function r(i,o){"object"==typeof i&&(o=i,i="string"),i=i||"string",o=o||{};var s=n({get:function(t){return"undefined"==typeof this.__meta.data[t]?o.defaultValue:this.__meta.data[t]},set:function(e,n){var r,i,s,a,u;r=this.__meta,s=t(this,"dirtyAttributes"),i=r.data,u=r.pristineData,s&&("undefined"==typeof u[n]?("undefined"==typeof i[n]?u[n]=o.defaultValue:u[n]=i[n],s.push(n)):(a=s.indexOf(n),u[n]===e&&~a?s.remove(n):~a||s.push(n))),i[n]=e}});return s.meta({type:i,isAttribute:!0,options:o,serialize:function(e){var n=s.meta(),r=n.key,i=t(this,r);return!e||e(n,r,i)?i:void 0},deserialize:function(t){return e(this,s.meta().key,t),t},revert:function(){var t,n,r;n=s.meta(),t=n.key,r=this.__meta.pristineData,r[t]&&e(this,t,r[t])}}),s.clone=function(){return r(i,o)},s}}).attach("$b"),t("brink/data/belongsTo",["../utils/get","../utils/set","../utils/computed"],function(e,n,r){return function i(o,s){s=s||{};var a=r({get:function(t){return this.__meta.data[t]},set:function(n,r){var i,a,u,c,l,f;i=this.__meta,u=this.store,c=e(this,"dirtyAttributes"),a=i.data,f=i.pristineData,c&&("undefined"==typeof f[r]?("undefined"==typeof a[r]?f[r]=s.defaultValue:f[r]=a[r],c.push(r)):(l=c.indexOf(r),f[r]===n&&~l?c.remove(r):~l||c.push(r))),!u||!n||n instanceof t.__models[o]?n&&t.assert('Must be a model of type "'+o+'".',n instanceof t.__models[o]):("string"!=typeof n&&"number"!=typeof n&&(n=String(n)),n=u.findOrCreate(o,n)),a[r]=n}});return a.meta({type:"belongsTo",isRelationship:!0,options:s,serialize:function(n){var r,i,u;return u=a.meta(),r=u.key,i=e(this,r),i&&i instanceof t.__models[o]&&(i=s.embedded?i.serialize(n):e(i,"pk")),!n||n(u,r,i)?i:void 0},deserialize:function(r,i,u){var c,l,f;return l=a.meta(),c=l.key,s.embedded&&(f=e(this,c)||t.__models[o].create(),r&&"object"==typeof r&&(r=f.deserialize(r,i,u))),n(this,c,r),r},revert:function(t){var n,r,i;i=a.meta(),n=i.key,r=e(this,n),r&&r.revert(t)}}),a.clone=function(){return i(o,s)},a}}).attach("$b"),t("brink/data/Collection",["../core/Array","../utils/get","../utils/set","../utils/computed"],function(t,e,n,r){var i=t({modelKey:null,collectionKey:null,modelClass:r({get:function(){return this._modelClass},set:function(t){this._modelClass=t,t&&(n(this,"modelKey",t.modelKey),n(this,"collectionKey",t.collectionKey))}}),__init:function(){this.__recordsByPK={},t.prototype.__init.apply(this,arguments)},findBy:function(e,n){var r,i;return r="pk"===e,r&&(i=this.__recordsByPK[n])?i:(i=t.prototype.findBy.call(this,e,n),r&&i&&(this.__recordsByPK[n]=i),i)},push:function(){var t,n,r,i;for(t=0,n=arguments.length;n>t;t++)i=arguments[t],r=e(i,"pk"),this.insertAt(this.length,i),r&&(this.__recordsByPK[r]=i);return this.length},serialize:function(t,e){var n=[];return this.forEach(function(r){t?n.push(r.serialize(e)):n.push(r.get("pk"))}),n},revertAll:function(t){this.forEach(function(e){e.revert(t)})},destroy:function(e){var n;if(e)for(n=this.content.length;n--;)this.content[n].destroy(!0);t.prototype.destroy.call(this)}});return i}).attach("$b"),t("brink/data/hasMany",["./Collection","../utils/get","../utils/set","../utils/computed"],function(e,n,r,i){return function o(s,a){a=a||{},a.map&&(a.embedded=!0);var u=i({get:function(t){return this.__meta.data[t]||(this.__meta.data[t]=e.create()),this.__meta.data[t]},set:function(r,i){var o,s,u,c,l,f;o=this.__meta,u=this.store,c=n(this,"dirtyAttributes"),s=o.data,f=o.pristineData,c&&("undefined"==typeof f[i]?("undefined"==typeof s[i]?f[i]=a.defaultValue:f[i]=s[i],c.push(i)):(l=c.indexOf(i),f[i]===r&&~l?c.remove(i):~l||c.push(i))),r&&t.assert("Must be a collection.",r instanceof e),s[i]=r}});return u.meta({type:"hasMany",isRelationship:!0,options:a,serialize:function(t){var e,r,i,o,s,c;if(c=u.meta(),o=c.key,i=a.map||{},r=n(this,o),r&&(r=r.serialize(a.embedded,t)),r&&a.map){for(s={},e=0;e<r.length;e++)i.value?s[r[e][i.key]]=r[e][i.value]:(s[r[e][i.key]]=r[e],delete r[e][i.key]);r=s}return!t||t(c,o,r)?r:void 0},deserialize:function(i,o,c){var l,f,h,p,d,y,m,g,_,v,b,w;if(g=u.meta(),p=g.key,d=a.map||{},_=this.store,i=i||[],a.map){m=[];for(l in i){h=i[l]&&!Array.isArray(i[l])&&"object"==typeof i[l]?i[l]:{value:i[l]},h.key=l,y={};for(f in h)y[d[f]||f]=h[f];m.push(y)}i=m}for(b=[],w=n(this,p)||e.create(),l=0;l<i.length;l++)i&&i[l]&&(a.embedded&&"object"==typeof i[l]?(v=t.__models[s].create(),_&&_.add(s,v),v.deserialize(i[l],o,c)):v=_?_.findOrCreate(s,i[l]):t.__models[s].create({pk:i[l]}),b.push(v));return w.set("content",b),r(this,p,w),w},revert:function(t){var e,i,o,s;o=u.meta(),e=o.key,s=this.__meta.pristineData,a.embedded?(i=n(this,e),i&&(s[e]=void 0,i.revertAll(t))):s[e]&&r(this,e,s[e])}}),u.clone=function(){return o(s,a)},u}}).attach("$b"),t("brink/data/Model",["../core/Class","../core/Array","../utils/get","../utils/set","../utils/bindTo","../utils/computed"],function(e,n,r,i,o,s){var a=e({store:null,adapter:null,modelKey:null,collectionKey:null,primaryKey:"id",dirtyAttributes:null,isSaving:!1,isFetching:!1,isLoaded:!1,isDeleting:!1,isDirty:s(function(){return!!r(this,"dirtyAttributes.length")},"dirtyAttributes.length"),isClean:s(function(){return!r(this,"isDirty")},"isDirty"),isNew:s(function(){return!r(this,"pk")},"pk"),pk:s({get:function(){return this.primaryKey?r(this,this.primaryKey):null},set:function(t){return this.primaryKey?i(this,this.primaryKey,t):null}}),__init:function(t){var e,r,o,s,a,u,c;if(this.__callInit=!1,this._super.call(this),o=this.__meta,a=this.constructor.__meta,o.data={},o.isInitialized=!1,a.attributes)o.attributes=a.attributes,o.relationships=a.relationships;else{u=[],c=[];for(e in o.properties)r=o.properties[e],s=r.meta&&r.meta(),s&&(s.isAttribute?u.push(e):s.isRelationship&&c.push(e));o.attributes=a.attributes=u,o.relationships=a.relationships=c}return o.pristineData={},o.pristineContent={},"object"==typeof t&&this.deserialize(t),i(this,"dirtyAttributes",n.create()),o.isInitialized=!0,this.init&&(this.__callInit=!0,this.init.apply(this,arguments)),this},serialize:function(t){var e,n,o,s,a,u,c,l,f,h,p,d,y;for(f=this.__meta,d=f.attributes,y=f.relationships,p=d.concat(y),l={},e=0,n=p.length;n>e;e++)o=p[e],c=this.prop(o),h=c.meta(),a=h.options.key||o,u=h.serialize.call(this,t),"undefined"!=typeof u&&i(l,a,u);return this.primaryKey&&(s=r(this,"pk"),"undefined"!=typeof s&&i(l,this.primaryKey,s)),l},deserialize:function(t,e,n){var o,s,a,u,c,l,f,h,p,d,y;if(l=this.__meta,!t)return this;for(p=r(this,"dirtyAttributes")||[],d=l.attributes,y=l.relationships,h=d.concat(y),o=h.length;o--;)s=h[o],c=this.prop(s),f=c.meta(),(e||!~p.indexOf(s))&&(a=f.options.key||s,u=r(t,a),"undefined"==typeof u||n&&!n(f,a,u)||(u=f.deserialize.call(this,u,e,n),l.pristineData[s]=u));return this.primaryKey&&t[this.primaryKey]&&i(this,"pk",t[this.primaryKey]),i(this,"isLoaded",!0),this},save:function(){var t,e;return t=this,e=r(this,"isNew"),i(this,"isSaving",!0),e&&t.store&&t.store.add(t),
this.adapter.saveRecord(this).then(function(e){t.deserialize(e),i(t,"isSaving",!1),i(t,"isLoaded",!0)})},fetch:function(){var e,n;return e=this,n=r(this,"isNew"),t.assert("Can't fetch records without a primary key.",!n),i(this,"isFetching",!0),this.adapter.fetchRecord(this).then(function(t){e.deserialize(t),i(e,"isFetching",!1),i(e,"isLoaded",!0)})},"delete":function(){var t,e;return t=this,e=r(this,"isNew"),i(this,"isDeleting",!0),this.adapter.deleteRecord(this).then(function(){t.store&&t.store.remove(this),t.destroy()})},clone:function(){var t=this.serialize();return"undefined"!=typeof t[this.primaryKey]&&delete t[this.primaryKey],this.constructor.create(t)},revert:function(t){var e,n,i,o,s,a,u,c,l,f;for(s=this.__meta,c=r(this,"dirtyAttributes"),l=s.attributes,f=s.relationships,u=l.concat(f),e=u.length;e--;)n=u[e],o=this.prop(n),a=o.meta(),i=a.options.key||n,(a.isAttribute||a.isRelationship&&(t||a.options.embedded))&&a.revert.call(this,t);return this}});return a.extend=function(){var n,r,i;return i=e.extend.apply(this,arguments),r=i.prototype,r.url&&(i.url=r.url),r.primaryKey&&(i.primaryKey=r.primaryKey),r.modelKey&&(n=i.__meta,r.collectionKey||(r.collectionKey=r.modelKey.concat("s")),i.modelKey=r.modelKey,i.collectionKey=r.collectionKey,t.registerModel(i)),r.adapter&&(i.adapter=r.adapter,r.adapter.registerModel(i)),i},a.unregister=function(){t.unregisterModel(this)},a}).attach("$b"),t("brink/data/Schema",["../core/CoreObject","../utils/extend"],function(t,e){var n=t.extend({__init:function(t){return this.__meta=this.__meta||{},this.__meta.isSchema=!0,e(this,t),this}});return n}).attach("$b"),t("brink/data/Store",["./Model","./Collection","../core/Class","../utils/get","../utils/set"],function(e,n,r,i,o){var s=r({init:function(){this.__registry=t.__models,this.__store={}},clear:function(){this.__store={}},add:function(t,e){var n,r,i,s;for(1===arguments.length?(e=t,e=Array.isArray(e)?e:[e],t=e[0].modelKey):e=Array.isArray(e)?e:[e],s=this.getCollection(t),n=0,r=e.length;r>n;n++)i=e[n],~s.indexOf(i)||(o(i,"store",this),s.push(i));return s},remove:function(t,e){var n,r,i,o;for(1===arguments.length?(e=t,e=Array.isArray(e)?e:[e],t=e[0].modelKey):e=Array.isArray(e)?e:[e],o=this.getCollection(t),n=0,r=e.length;r>n;n++)i=e[n],o.remove(e[n]);return o},all:function(t){return this.getCollection(t)},fetchAll:function(t){var e,n,r,i,o;return r=this.modelFor(t),o=r.primaryKey,r.adapter.fetchAll(r).then(function(t){for(t=Array.isArray(t)?t:[t],e=0;e<t.length;e++)n=t[e],i=this.findOrCreate(r,n[r.primaryKey]),i.deserialize(n);return this.all(r)}.bind(this))},find:function(t,e){var n;return n=this.getCollection(t),"number"==typeof e||"string"==typeof e?n.findBy("pk",e):"function"==typeof e?n.find(e):n.find(function(t){var n;for(n in e)if(i(t,n)!==e[n])return!1;return!0},this)},findOrCreate:function(t,e){var n;return e&&(n=this.find(t,e)),n||(n=this.modelFor(t).create(),o(n,"pk",e),this.add(t,n)),n},createRecord:function(t,e){var n;return n=this.modelFor(t).create(e),this.add(t,n),n},filter:function(t,e){var n;return n=this.getCollection(t),"function"==typeof e?n.filter(e):n.filter(function(t){var n,r;r=!0;for(n in e)i(t,n)!==e[n]&&(r=!1);return r},this)},getCollection:function(t){var e,n;if(e=this.modelFor(t),!e)throw new Error('No model was found with a modelKey of "'+t+'"');return n=this.__store[e.collectionKey],n||(n=this.__store[e.collectionKey]=this.createCollection(e)),n},createCollection:function(t){var e,r;if(e=this.modelFor(t),!e)throw new Error('No model was found with a modelKey of "'+t+'"');return r=n.create(),o(r,"modelClass",e),r},modelFor:function(t){return"string"!=typeof t?t:this.__registry[t]},destroy:function(t){var e;if(t)for(e in this.__store)this.__store[e].destroy(!0);this.__registry=null,this.__store={},this._super.apply(this,arguments)}});return s}).attach("$b")}).call(this);